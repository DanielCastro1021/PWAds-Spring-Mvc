<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
</head>
<body>

<nav class="navbar navbar-inverse">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="/index.html">PWAds</a>
        </div>
        <ul class="nav navbar-nav">
            <li id="home-tab-button"><a href="/index.html">Home</a></li>

            <li id="ads-tab-button" style="display: flex">
                <a class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton1"
                   data-bs-toggle="dropdown" aria-expanded="false">
                    List of Ads
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                    <li><a id="all-ads-btn" href="/components/ads/list-ads.html?ads=all">All Ads</a></li>
                    <li><a id="basic-ads-btn" href="/components/ads/list-ads.html?ads=basic">Basic Ads</a></li>
                    <li><a id="car-ads-btn" href="/components/ads/list-ads.html?ads=car">Car Ads</a></li>
                </ul>
            </li>
            <li id="my-ads-tab-button" style="display: flex">
                <a class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton2"
                   data-bs-toggle="dropdown" aria-expanded="false">
                    My Ads
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                    <li><a id="my-ads-btn" href="/components/ads/list-ads.html?ads=my_ads">List My Ads</a></li>
                    <li><a id="create-ad-btn" href="/components/ads/create-ad.html">New Ad</a></li>
                </ul>
            </li>
            <li id="messages-tab-button"><a
                    href="/components/messages/list-messages.html?messages=received">Messages</a>
            </li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li id="register"><a href="/components/authentication/register.html"><span
                    class="glyphicon glyphicon-user"></span> Sign
                Up</a>
            </li>
            <li id="login"><a href="/components/authentication/login.html"><span
                    class="glyphicon glyphicon-log-in"></span>
                Login</a>
            </li>
            <li id="logout" onclick="logout()"><a href="../index.html"><span
                    class="glyphicon glyphicon-log-out"></span>
                Logout</a>
            </li>
        </ul>
    </div>
</nav>
<script>
    const token = localStorage.getItem("token");

    function checkToken(token) {
        if (token === null) {
            logout();
        } else {
            const decode = JSON.parse(atob(token.split('.')[1]));
            if (decode.exp * 1000 < new Date().getTime()) {
                logout();
            } else {
                $("#register").hide();
                $("#login").hide();
                $("#messages-tab-button").show();
                $("#my-ads-tab-button").show();
                $("#logout").show();
            }
        }
    }


    function logout() {
        if (localStorage.length > 1) {
            localStorage.clear();
            window.location.href = "../index.html";
        }
        $("#register").show();
        $("#login").show();
        $("#logout").hide();
        $("#messages-tab-button").hide();
        $("#my-ads-tab-button").hide();
    }

    checkToken(token);

</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>
</body>
</html>
